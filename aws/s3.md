# S3について

## 概要

Amazon Simple Storage Service (Amazon S3)は、AWSが提供するオブジェクトストレージ。<br />
一般的なストレージとは異なり、"オブジェクト"単位でデータを管理する。<br />
フラットに"オブジェクト"を管理するため、分散化・スケールアウトしやすいことに加えて、より柔軟なデータ保存が可能になる。<br />
S3は、オブジェクトストレージならではの特性を活かし、容量無制限で利用できる耐久性・可用性の高さを特徴として持ち、サーバーのストレージ領域としての活用からデータバックアップや機械学習などで利用するデータの保存場所など、幅広い用途に対応する。<br />

## S3のメリット
### 優れた耐久性・可用性
Amazon S3は、AWSの堅牢なデータセンターで運用されている上、複数のアベイラビリティゾーン（AZ、データセンター）にデータを格納することで99.9999999%の耐久性を実現している。<br />
つまり、ストレージ故障などによるデータ損失はほぼ発生しないと考えて良いことになる。<br />
また、標準的なストレージクラス（S3標準）において99.9%の可用性が保障されている。<br />


### 低コストで利用可能
Amazon S3も"使った分だけ"の従量課金で利用可能。<br />
単価はストレージの種類によって異なるが、S3標準でも、最初の50TBまでは１ヶ月あたり$0.025/GBに設定されており、コストを抑えて利用できる。<br />
また、将来的な利用を想定して容量を確保する必要もないため、無駄なコストがかからない点も魅力である。<br />


### サーバー不要で静的コンテンツのWeb公開が可能
様々な機能を持つS3だが、中でも便利な機能の1つが「静的ウェブサイトホスティング」である。<br />
これはHTMLファイルなどの静的なコンテンツに対してアクセス可能なエンドポイント（URL）を発行する機能で、Webサーバを立てることなく静的コンテンツで構成されるWebサイトを公開できる。<br />


### データの保持期間をコントロールできる

S3の便利な機能としてデータの「ライフサイクル」を設定できることが挙げられる。<br />
これはアップロードしたファイルなどを一定期間後に異なるストレージクラスへの移動や削除をするもの。<br />
例えば一時的なファイル保管場所としてS3を利用する際、「１週間後に自動で削除する」ことで不要なファイルが残ることを防ぐ。<br />
S3のバケット他にで設定するほか、フォルダなど細かな単位で設定することも可能で柔軟な運用をサポートする。<br />


### 柔軟な権限管理

データの公開範囲やアクセス権限などを細かく設定できるのも特徴の1つ。<br />
S3バケットごとに外部への公開・非公開を設定するほかAWS環境にアクセスする「IAMユーザー」単位でアクセス可能なフォルダを指定することも可能。<br />
またユーザグループごとに設定することもでき、柔軟かつ効率的な管理を実現する。<br />


### 補完する"場所"を自由に指定可能
AWSは世界にリージョンを展開しており、S3のデータ保管場所を自由に指定できる。<br />
国内では東京と大阪に2つのリージョンがあるほか、アジアでは韓国やシンガポール、もちろん米国などへのデータ保存も簡単。<br />
オンプレミスで遠隔地にストレージ環境を用意するとなるとデータセンターやハードウェア用意のハードルが高く、さらにデータをどう移動するかも課題となる。<br />
S3ならバケット作成時にリージョンを指定するだけでよく、ファイルをアップロードするだけで、地理的に離れた場所へのデータ補完が可能になる。<br />


「DR対策としてバックアップデータを国外に保管したい」というケースのほか、シビアな読み込み時間が要求されるコンテンツでは海外展開時に現地に近いリージョンに配置するといった手段を選択することも可能。<br />


## S3のユースケース

### ログデータの保存
S3の主な利用方法としてほかのAWSサービスのログデータ保存が挙げられる。<br />
ロードバランサ「ELB」やCDNサービス「Amazon CloudFront」、EC2などから出力されるログデータなど各種ログの保存先として利用される。<br />
また、S3に保存したログはAmazon Athenaで分析、Amazon QuickSightで可視化するなど、様々なAWSサービスと連携して利用される。<br />


### データアーカイブ先として
企業のビジネスにおいて、長期にわたって保管しなければならないデータは意外と多いが、オンプレミスのストレージは有限であり、保管場所に悩むケースは少なくない。<br />

S3であれば容量無制限で利用可能であり、オンプレミスで保存しきれないものを長期保存することも可能である。<br />
S3はストレージの種類によって料金も変わり、「閲覧頻度が数年に１度程度と著しく低く、閲覧時にもデータの要求から1日後に取り出せばよい」というものであれば、S3 Glacierを選ぶことでさらにコストを抑えることも可能。<br />
「閲覧はしないが、長期保存しなければならない」監査対応で保管するデータなどに最適である。<br />


[![Image from Gyazo](https://i.gyazo.com/a1044f38d92d95cfdf77eae5145907c0.png)](https://gyazo.com/a1044f38d92d95cfdf77eae5145907c0)<br />

### 静的Webサイトのホスティング

メリットの3つ目で紹介した静的ウェブサイトホスティング機能によるWebサイト公開がある。<br />
基本的な構成としてコンテンツ配信サービスである「Amazon CloudFront」と組み合わせることでS3に保存したHTMLなどのコンテンツをWebサイトとして公開する形。<br />

また、S3では静的なコンテンツしか対応できないが、動的コンテンツはEC2上のサーバに配置し、画像などの静的コンテンツはS3に配置する形で利用するケースもある。<BR />

画像などは容量が大きいものが多く、容量単価が安く、高い耐久性・可用性を誇るS3に配置することでコストを抑えて安定した環境を実現できる。<br />

### 大容量ファイルのアップロード
オンプレミスからのデータ移行などで数十〜数百GBにおよぶデータをS3にアップロードするケース。<br />
AWS CLIやAWS SDKなどのAPIを利用してS3にデータアップロードを行うと一定以上の容量のファイルには「マルチパートアップロード」が自動で定期要される。<br />
大容量ファイルを一気に送信するとネトワーク回線の帯域が逼迫し、他の業務への影響が懸念されるがマルチパートアップロードでデータを細かく分割して送信することでネットワークへの影響を回避できる。<br />
部分的に送信に失敗した場合にはアップロード終了後に該当データのみリトライされるため「大容量データすべてを再度アップロードし直し」といったことにもならず、効率的なデータアップロードを実現できる。<br />


## 参考文献
[公式ドキュメント](https://docs.aws.amazon.com/ja_jp/AmazonS3/latest/userguide/Welcome.html)<br />

[クラスメソッド](https://classmethod.jp/aws/articles/aws-s3/)


